# MessageIn 进程保护功能说明

## 概述

MessageIn应用现在具备强大的进程保护功能，可以有效防止用户通过任务管理器或其他方式非法关闭应用。

## 保护机制

### 1. 应用级保护

- **窗口关闭拦截**: 拦截所有窗口的关闭事件，要求密码验证
- **进程信号处理**: 监听SIGTERM、SIGINT、SIGQUIT等终止信号
- **异常恢复**: 自动检测和恢复崩溃的窗口
- **进程监控**: 定期检查应用状态，自动重启异常进程

### 2. 系统级保护

- **Windows服务**: 可安装为系统服务，开机自启动
- **进程守护**: 独立的进程保护器，监控主应用进程
- **自动重启**: 检测到进程异常时自动重启

## 使用方法

### 方法一：直接启动（推荐）

```bash
# 在display目录下运行
node process-protection.js
```

### 方法二：使用批处理脚本

```bash
# 双击运行或命令行执行
start-protected.bat
```

### 方法三：安装为Windows服务（最高级别保护）

#### 安装服务

1. 以管理员身份运行PowerShell
2. 执行安装命令：

```powershell
.\install-service.ps1 -Install
```

#### 启动服务

```powershell
.\install-service.ps1 -Start
```

#### 停止服务

```powershell
.\install-service.ps1 -Stop
```

#### 卸载服务

```powershell
.\install-service.ps1 -Uninstall
```
